# Liquid Investigations: OpenVPN Configuration PoC

This repository houses some python scripts to configure OpenVPN. This is to be
integrated with the setup repository, but serves for now as a PoC. It is
inspired by [this](https://www.digitalocean.com/community/tutorials/how-to-set-up-an-openvpn-server-on-ubuntu-16-04)
tutorial. Revoking certificates is discussed [here](https://blog.remibergsma.com/2013/02/27/improving-openvpn-security-by-revoking-unneeded-certificates/).

To play with this setup, run `vagrant up` in the `Vagrant/` folder.

### Prerequisites

The `Vagrantfile` takes care of all the setup, and installs the following
prerequisites (see `./Vagrant/Readme.md` for details).:

 - Ubuntu 16.10
 - python3-pip
 - OpenVPN
 - easy-rsa
 - virtualenv

It then creates a virtualenv, and installs Python dependencies from
`requirements.txt`

### Scripts

`./generate-server-keys.py`:

This script creates a CA and generates all of the necessary OpenVPN server keys.
It uses some default settings (see the file for details). Does not need to be
run as a privileged user.

`./setup-network.py`:

Network/system configuration setup. Changes forwarding and iptables settings,
starts openvpn. Should be run as a priveleged user. See file for details.

`./configure-openvpn.py`:

This script uses the certs and keys generated by `generate-server-keys.py`,
configures OpenVPN via `templates/server.conf.j2`, and starts the OpenVPN server.
Should be run as a privileged user. See file for details.

TODO: `./create-client-ovpn.py`:

This script creates an .ovpn file for client use, first creating the necessary
client keys. See the file for details.
